<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WeFind üîç ‚Äî KLH Lost & Found</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root {
  --primary: #0066ff;
  --secondary: #00c6ff;
  --accent: #ffb300;
  --danger: #ff4d6d;
  --bg-light: #f0f9ff;
  --bg-dark: #0a1628;
  --card-light: rgba(255,255,255,0.85);
  --card-dark: rgba(0,0,0,0.4);
  --text-light: #111;
  --text-dark: #eee;
}
* { box-sizing: border-box; transition: all .3s ease; }

body {
  font-family: 'Poppins', sans-serif;
  margin: 0;
  min-height: 100vh;
  background: linear-gradient(135deg, var(--secondary), var(--primary));
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px;
  color: var(--text-light);
}
body.dark {
  background: linear-gradient(135deg, #00111f, #022d54);
  color: var(--text-dark);
}

.app {
  display: grid;
  grid-template-columns: 360px 1fr;
  gap: 25px;
  width: 100%;
  max-width: 1200px;
}

.panel {
  background: var(--card-light);
  border-radius: 20px;
  padding: 25px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.15);
  backdrop-filter: blur(10px);
}
body.dark .panel { background: var(--card-dark); }

.logo {
  font-weight: 700;
  font-size: 1.8rem;
  background: linear-gradient(90deg, var(--secondary), var(--accent));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-align: center;
  margin-bottom: 10px;
}

input, textarea, select {
  width: 100%;
  padding: 10px 14px;
  margin-top: 8px;
  border-radius: 10px;
  border: 1px solid #ccc;
  outline: none;
}
input:focus, textarea:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(0,119,255,0.1);
}
.btn {
  background: linear-gradient(90deg, var(--secondary), var(--primary));
  color: white;
  padding: 10px 16px;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  font-weight: 600;
  transition: .3s;
}
.btn:hover {
  transform: scale(1.05);
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}

.usercard {
  background: linear-gradient(135deg, #e8f6ff, #ffffff);
  border-radius: 12px;
  padding: 12px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.avatar {
  background: var(--primary);
  color: white;
  border-radius: 50%;
  width: 50px; height: 50px;
  display: flex; align-items: center; justify-content: center;
  font-weight: 700;
}
.dark .usercard { background: rgba(255,255,255,0.1); }

#feedArea {
  display: grid;
  gap: 20px;
}
.card {
  background: var(--card-light);
  border-radius: 16px;
  padding: 15px;
  display: flex;
  gap: 15px;
  align-items: flex-start;
  box-shadow: 0 5px 20px rgba(0,0,0,0.1);
  border-left: 5px solid var(--primary);
  animation: fadeIn .5s ease forwards;
}
body.dark .card { background: var(--card-dark); }

@keyframes fadeIn {
  from {opacity:0; transform:translateY(10px);}
  to {opacity:1; transform:translateY(0);}
}

.thumb {
  width: 120px; height: 100px;
  border-radius: 10px; overflow: hidden;
  background: #f1faff;
  display: flex; align-items: center; justify-content: center;
}
.thumb img { width: 100%; height: 100%; object-fit: cover; }

.meta h3 { margin: 0; color: var(--primary); }
.dark .meta h3 { color: var(--secondary); }
.meta p { margin: 6px 0; font-size: .95rem; }

.actions {
  margin-top: 10px; display: flex; gap: 10px; flex-wrap: wrap;
}

.likeBtn, .claimBtn {
  background: var(--primary);
  color: #fff;
  border-radius: 8px;
  border: none;
  padding: 6px 12px;
  cursor: pointer;
  font-weight: 600;
  font-size: .9rem;
}
.likeBtn:hover { background: #0094ff; }
.claimBtn { background: var(--accent); }
.claimBtn:hover { background: #ffc046; }

.topbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}
.search, .filter, .sort {
  padding: 10px;
  border-radius: 10px;
  border: 1px solid #ccc;
  margin-right: 8px;
}

.toggle {
  background: none;
  border: 2px solid var(--primary);
  color: var(--primary);
  border-radius: 50%;
  width: 40px;
  height: 40px;
  cursor: pointer;
  font-size: 18px;
}
.dark .toggle {
  color: #ffeb3b;
  border-color: #ffeb3b;
}

/* Toast */
.toast {
  position: fixed;
  bottom: 25px;
  right: 25px;
  background: var(--primary);
  color: white;
  padding: 12px 20px;
  border-radius: 8px;
  font-weight: 600;
  opacity: 0;
  transform: translateY(20px);
  transition: all .5s ease;
}
.toast.show {
  opacity: 1;
  transform: translateY(0);
}
</style>
</head>
<body>
<div class="app">
  <!-- LEFT -->
  <div class="panel">
    <div class="logo">üîç WeFind</div>
    <p style="text-align:center;">KLH Lost & Found Portal</p>
    <div id="authArea">
      <input type="email" id="emailInput" placeholder="yourname@klh.edu.in">
      <button class="btn" id="signInBtn">Sign in</button>
    </div>

    <div id="userArea" style="display:none;">
      <div class="usercard">
        <div class="avatar" id="avatar">A</div>
        <div>
          <div id="userName">User</div>
          <small id="userEmail"></small>
        </div>
        <button id="signOutBtn" class="btn">Sign out</button>
      </div>
      <hr>
      <h3>Post an Item</h3>
      <form id="postForm">
        <input id="title" placeholder="Item title" required>
        <textarea id="desc" placeholder="Description" required></textarea>
        <input type="file" id="imageInput" accept="image/*">
        <img id="previewImg" style="max-width:100%; margin-top:10px; border-radius:10px; display:none;">
        <select id="statusSelect">
          <option>Lost</option>
          <option>Found</option>
        </select>
        <button class="btn" type="submit">Post</button>
      </form>
    </div>
  </div>

  <!-- RIGHT -->
  <div>
    <div class="topbar">
      <div>
        <select id="filterSelect" class="filter">
          <option value="All">All</option>
          <option value="Lost">Lost</option>
          <option value="Found">Found</option>
        </select>
        <select id="sortSelect" class="sort">
          <option value="newest">Newest</option>
          <option value="oldest">Oldest</option>
          <option value="likes">Most Liked</option>
        </select>
        <input id="searchInput" class="search" placeholder="Search...">
      </div>
      <button class="toggle" id="themeToggle">üåô</button>
    </div>
    <div id="feedArea"></div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
const toast=document.getElementById("toast");
const emailInput=document.getElementById("emailInput");
const signInBtn=document.getElementById("signInBtn");
const signOutBtn=document.getElementById("signOutBtn");
const authArea=document.getElementById("authArea");
const userArea=document.getElementById("userArea");
const avatar=document.getElementById("avatar");
const userName=document.getElementById("userName");
const userEmail=document.getElementById("userEmail");
const postForm=document.getElementById("postForm");
const feedArea=document.getElementById("feedArea");
const filterSelect=document.getElementById("filterSelect");
const searchInput=document.getElementById("searchInput");
const themeToggle=document.getElementById("themeToggle");
const previewImg=document.getElementById("previewImg");
const sortSelect=document.getElementById("sortSelect");

let posts=JSON.parse(localStorage.getItem("posts")||"[]");
let currentUser=JSON.parse(localStorage.getItem("user")||"null");

function showToast(msg){
  toast.textContent=msg;
  toast.classList.add("show");
  setTimeout(()=>toast.classList.remove("show"),2500);
}

function renderFeed(){
  feedArea.innerHTML="";
  let filter=filterSelect.value;
  let keyword=searchInput.value.toLowerCase();
  let sort=sortSelect.value;
  let filtered=posts.filter(p=>
    (filter==="All"||p.status===filter) &&
    (p.title.toLowerCase().includes(keyword)||p.desc.toLowerCase().includes(keyword))
  );
  if(sort==="newest") filtered.sort((a,b)=>b.time-a.time);
  if(sort==="oldest") filtered.sort((a,b)=>a.time-b.time);
  if(sort==="likes") filtered.sort((a,b)=>(b.likes||0)-(a.likes||0));

  if(filtered.length===0){feedArea.innerHTML="<p>No posts found.</p>";return;}

  filtered.forEach(p=>{
    const card=document.createElement("div");
    card.className="card";
    card.innerHTML=`
      <div class='thumb'>${p.image?`<img src="${p.image}">`:"üì¶"}</div>
      <div class='meta'>
        <h3>${p.title}</h3>
        <p>${p.desc}</p>
        <small>${p.status} ‚Ä¢ by ${p.user}</small>
        <div class='actions'>
          <button class='likeBtn'>‚ù§Ô∏è ${p.likes||0}</button>
          <button class='claimBtn'>üì© Contact Owner</button>
          <span class='badge'>${new Date(p.time).toLocaleString()}</span>
        </div>
      </div>`;
    card.querySelector(".likeBtn").onclick=()=>{
      p.likes=(p.likes||0)+1; savePosts(); renderFeed();
      showToast("You liked this post ‚ù§Ô∏è");
    };
    card.querySelector(".claimBtn").onclick=()=>{
      alert(`Contact ${p.user} at ${p.email}`);
      showToast("Claim request sent üíå");
    };
    feedArea.appendChild(card);
  });
}
function savePosts(){localStorage.setItem("posts",JSON.stringify(posts));}

signInBtn.onclick=()=>{
  const email=emailInput.value.trim();
  if(!email.endsWith("@klh.edu.in")) return alert("Use your @klh.edu.in email");
  const name=email.split("@")[0];
  currentUser={email,name};
  localStorage.setItem("user",JSON.stringify(currentUser));
  showUser(); showToast("Welcome back, "+name+" üëã");
};
signOutBtn.onclick=()=>{
  localStorage.removeItem("user");
  currentUser=null;
  authArea.style.display="block";
  userArea.style.display="none";
  showToast("Signed out successfully üëã");
};
function showUser(){
  authArea.style.display="none";
  userArea.style.display="block";
  avatar.textContent=currentUser.name[0].toUpperCase();
  userName.textContent=currentUser.name;
  userEmail.textContent=currentUser.email;
}
postForm.onsubmit=(e)=>{
  e.preventDefault();
  const title=document.getElementById("title").value.trim();
  const desc=document.getElementById("desc").value.trim();
  const status=document.getElementById("statusSelect").value;
  const img=document.getElementById("imageInput").files[0];
  if(!title||!desc)return;
  if(img){
    const r=new FileReader();
    r.onload=()=>{
      posts.push({title,desc,status,image:r.result,user:currentUser.name,email:currentUser.email,time:Date.now(),likes:0});
      savePosts();renderFeed();postForm.reset();previewImg.style.display="none";showToast("Item posted successfully üì¶");
    };
    r.readAsDataURL(img);
  }else{
    posts.push({title,desc,status,image:"",user:currentUser.name,email:currentUser.email,time:Date.now(),likes:0});
    savePosts();renderFeed();postForm.reset();showToast("Item posted successfully üì¶");
  }
};
document.getElementById("imageInput").onchange=(e)=>{
  const f=e.target.files[0];
  if(!f)return;
  const r=new FileReader();
  r.onload=()=>{previewImg.src=r.result;previewImg.style.display="block";};
  r.readAsDataURL(f);
};

filterSelect.onchange=()=>renderFeed();
searchInput.oninput=()=>renderFeed();
sortSelect.onchange=()=>renderFeed();

themeToggle.onclick=()=>{
  document.body.classList.toggle("dark");
  themeToggle.textContent=document.body.classList.contains("dark")?"‚òÄÔ∏è":"üåô";
};

if(currentUser)showUser();
renderFeed();
</script>
</body>
</html>